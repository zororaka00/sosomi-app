import{af as $,r as m,am as r}from"./index-CdOfnMph.js";const f=3e3,h=5e3,M=$("bitcoin",()=>{const T=m(!1),w=m(null),i=[];let u=!1,l=0;const p=async()=>{if(!(u||i.length===0)){for(u=!0;i.length>0;){const e=Date.now()-l;if(e<f){const o=f-e;console.log(`â³ Rate limit: waiting ${o}ms before next request...`),await new Promise(n=>setTimeout(n,o))}const s=i.shift();if(s)try{l=Date.now();const o=await s.fn();s.resolve(o)}catch(o){(o?.response?.status===429||o?.message?.toLowerCase().includes("rate limit")||o?.message?.toLowerCase().includes("too many"))&&(console.warn(`âš ï¸ Rate limit detected! Waiting ${h}ms before retry...`),await new Promise(c=>setTimeout(c,h)),l=Date.now()),s.reject(o)}}u=!1}},a=t=>new Promise((e,s)=>{i.push({fn:t,resolve:e,reject:s}),p()}),d=t=>(t/1e8).toFixed(8);return{loading:T,error:w,getTransaction:async t=>a(async()=>{console.log(`ðŸ”„ Fetching Bitcoin transaction: ${t}`);const e=await r.get(`/tx/${t}`);return console.log("âœ… Bitcoin transaction fetched"),e.data}),getAddress:async t=>a(async()=>{console.log(`ðŸ”„ Fetching Bitcoin address: ${t}`);const e=await r.get(`/address/${t}`);return console.log("âœ… Bitcoin address fetched"),e.data}),getAddressTransactions:async t=>a(async()=>{console.log(`ðŸ”„ Fetching transactions for address: ${t}`);const e=await r.get(`/address/${t}/txs`);return console.log(`âœ… Fetched ${e.data.length} transactions`),e.data}),getAddressUtxo:async t=>a(async()=>{console.log(`ðŸ”„ Fetching UTXOs for address: ${t}`);const e=await r.get(`/address/${t}/utxo`);return console.log(`âœ… Fetched ${e.data.length} UTXOs`),e.data}),getBlock:async t=>a(async()=>{console.log(`ðŸ”„ Fetching block: ${t}`);const e=await r.get(`/block/${t}`);return console.log("âœ… Block fetched"),e.data}),getFeeEstimates:async()=>a(async()=>{console.log("ðŸ”„ Fetching fee estimates");const t=await r.get("/fee-estimates");return console.log("âœ… Fee estimates fetched"),t.data}),satoshisToBTC:d,formatBTC:t=>{const e=d(t);return parseFloat(e).toString()},calculateInputTotal:t=>t.vin.reduce((e,s)=>s.prevout?e+s.prevout.value:e,0),calculateOutputTotal:t=>t.vout.reduce((e,s)=>e+s.value,0),calculateBalance:t=>{const e=t.chain_stats.funded_txo_sum-t.chain_stats.spent_txo_sum,s=t.mempool_stats.funded_txo_sum-t.mempool_stats.spent_txo_sum;return e+s},formatTimestamp:t=>new Date(t*1e3).toLocaleString(),getTimeAgo:t=>{const s=Date.now()-t*1e3,o=Math.floor(s/1e3),n=Math.floor(o/60),c=Math.floor(n/60),g=Math.floor(c/24);return g>0?`${g} day${g>1?"s":""} ago`:c>0?`${c} hour${c>1?"s":""} ago`:n>0?`${n} minute${n>1?"s":""} ago`:`${o} second${o>1?"s":""} ago`},isValidBitcoinAddress:t=>{const e=/^[1][a-km-zA-HJ-NP-Z1-9]{25,34}$/,s=/^[3][a-km-zA-HJ-NP-Z1-9]{25,34}$/,o=/^(bc1|tb1)[a-z0-9]{39,87}$/;return e.test(t)||s.test(t)||o.test(t)},isValidBitcoinTxid:t=>/^[a-f0-9]{64}$/i.test(t),getQueueStatus:()=>({queueLength:i.length,isProcessing:u})}});export{M as u};
